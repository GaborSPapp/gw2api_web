<!DOCTYPE html>
<html>
<head>
  <title>gw2 helper</title>
</head>

<body>
  <label for="variable">Recipe id:</label><br>
  <input type="text" id="variable" value="">
  <button onclick="query()" value="">get</button>
  <pre id="api_query">loading...</pre>
  
  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const param = urlParams.get('recipe');
    if (param) {
      document.getElementById("variable").value = param;
    }
    
    const Http = new XMLHttpRequest();
    const url='https://api.guildwars2.com/v2/recipes/'+param;
    Http.open("GET", url);
    Http.send();

    Http.onreadystatechange = (e) => {
      console.log("Request status: " + Http.status);
      if (Http.status == 200 || Http.status == 206) {
        document.getElementById("api_query").innerHTML = Http.responseText;
      } else if (Http.status == 403 || Http.status == 404) {
        document.getElementById("api_query").innerHTML = Http.responseText;
      } else if (Http.status == 400) {
        document.getElementById("api_query").innerHTML = Http.responseText;
      } else {
        document.getElementById("api_query").innerHTML = "no data";
      }
    }
    
    function query() {
      let variable = document.getElementById('variable').value;
      window.location.href = location.protocol + '//' + location.host + location.pathname + "?recipe=" + variable;
    }
  </script>
</body>

</html>
